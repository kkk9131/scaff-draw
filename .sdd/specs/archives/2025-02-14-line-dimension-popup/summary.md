# Line Dimension Popup Archive Summary

## Completion Validation
- 要件・設計・タスク文書は同フォルダに保管済みで、実装内容と乖離はありません。
- 設計時の未確定事項のうち「ミッドポイント固定」「リアルタイムプレビューなし」は据え置き、長さ検証については `snapSize * 2` の倍数制約を導入する設計変更を反映済み。

## Delivered Outcomes
- React/Konva 上でラインを選択するとポータル表示される寸法入力ポップアップを実装。寸法確定でライン長を再計算し、スナップを尊重した再描画を行う。
- ラインデータモデル (`ScaffoldLine`) の導入、JSON エクスポートへのライン出力、長さ再計算ロジックのユーティリティ化、入力バリデーション実装。
- テスト: `npm run test` にユニット (スナップ, ライン幾何, バリデーション) を追加し、`npm run lint` 合格を確認。

## Remaining Follow-Ups
- ブロック操作とライン配列の同期（割付や削除でラインを更新する仕組み）。
- ライン作図機能そのもの（ドラッグでラインを追加）と、そのための新規仕様策定。
- a11y 自動テスト（axe など）の追加、およびズーム／パン対応時のポップアップ位置補正検証。

## Retrospective Notes
- 良かった点: Konva 座標変換と React ポータルの組み合わせがシンプルに機能し、既存 UI へ最小限の変更で統合できた。
- 苦労した点: スナップ単位との整合を保つ長さ更新は要件不明瞭だったため、`snapSize * 2` 倍数という制約を追加しながら実装。初期タスクには描画機能が含まれていないためユーザー期待と差が出た。
- 次回改善: スナップ仕様や描画フローは初期段階で明文化し、ライン生成／編集の包括的な UX を設計段階でまとめると後工程がスムーズ。

## Rollout Status
- ローカル環境のみ。起動は `npm run dev`。描画機能拡張を行う場合は新仕様を作成して対応する。
