# 要件定義書

## 機能概要
左サイドバーにスナップ単位を切り替えるトグルボタンを追加し、キャンバス上のグリッド表示とスナップ計算を 150mm／300mm のいずれかへ即時反映させる。これにより、粗いレイアウトと精密配置をワンクリックで切り替えられる作図体験を提供する。

## ユーザーストーリー
- ユーザーとして、作業内容に応じてスナップ単位を瞬時に切り替えたい。なぜなら、粗いレイアウト作成と細かな寸法調整を同じキャンバスで効率良く行いたいからだ。

## 機能要件
### 要件1：スナップ単位切替UI
- 左サイドバー最上部に「スナップ単位: 150mm / 300mm」と状態が分かるトグルボタンを配置する。
- 初期状態は 300mm とし、クリックごとに 150mm ↔ 300mm を交互に切り替える。切替時はボタン表示を即時更新し、現在値が明確に分かるようにする。
- 受入基準：
  - [ ] 左サイドバーにトグルボタンが配置され、現在のスナップ単位を表示していること。
  - [ ] ボタンをクリックすると 150mm と 300mm が交互に切り替わり、表示も同期して変化すること。

### 要件2：グリッド表示との連動
- キャンバスのグリッド描画は選択中のスナップ単位に合わせて表現を切り替える。
  - 150mm 選択時は 150mm 補助線を薄く、300mm 主グリッドを濃く表示する。
  - 300mm 選択時は 300mm 主グリッドのみを強調し、150mm 補助線は表示しない（もしくはより薄くする）。
- 受入基準：
  - [ ] スナップ単位を 150mm に切り替えると、150mm グリッドが補助線として表示されること。
  - [ ] スナップ単位を 300mm に戻すと、150mm 補助線が非表示または目立たない状態になり、300mm グリッドのみが強調されること。

### 要件3：スナップ計算の適用
- ブロックのドラッグ終了や新規配置、テキストメモ配置などの座標は選択中のスナップ単位で丸める。
  - 計算式例：`snappedX = Math.round(x / snapSize) * snapSize`。
- スナップ単位変更後は、以降の操作に即時反映されること。
- 受入基準：
  - [ ] ブロックをドラッグして離すと、座標が現在のスナップ単位の整数倍に丸められることが確認できること。
  - [ ] メモやマーカーなど他要素の配置／移動も同じスナップ単位で丸められること。

## 非機能要件
- パフォーマンス：スナップ単位を切り替えた際、UI とグリッド表示、スナップ処理が 200ms 以内で更新されること。
- セキュリティ：ローカル専用アプリのため追加要件はなし。
